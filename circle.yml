machine:
  environment:
    GO15VENDOREXPERIMENT: 1
    GOROOT: "/home/ubuntu/go"
    PATH: "/home/ubuntu/go/bin:/usr/local/bin:$GOPATH/bin:$PATH"
    GOVERSION: "1.7.4"

dependencies:
  pre:
    # Install Golang
    - |
      curl -o go.tar.gz -sL https://storage.googleapis.com/golang/go$GOVERSION.linux-amd64.tar.gz &&
      sudo rm -rf /usr/local/go &&
      sudo tar -C /usr/local -xzf go.tar.gz &&
      sudo chmod a+w /usr/local/go/src/ &&
      ls -la /usr/local/go/src/ &&
      go version
    # Install Glide
    - |
      curl -o glide.tar.gz -sL https://github.com/Masterminds/glide/releases/download/v0.12.3/glide-v0.12.3-linux-amd64.tar.gz &&
      tar -xvzf glide.tar.gz &&
      ls -la &&
      sudo cp linux-amd64/glide /usr/local/bin/glide &&
      sudo chmod a+w /usr/local/bin/glide &&
      glide --version

  override:
    - glide update -v

test:
  override:
    - go test -v