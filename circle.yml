machine:
  environment:
    GO15VENDOREXPERIMENT: 1
    GOROOT: "/home/ubuntu/go"
    PATH: "/home/ubuntu/go/bin:$PATH"
    GOVERSION: "1.7.4"

dependencies:
  pre:
    - |
      curl -o go.tar.gz -sL https://storage.googleapis.com/golang/go$GOVERSION.linux-amd64.tar.gz &&
      sudo rm -rf /usr/local/go &&
      sudo tar -C /usr/local -xzf go.tar.gz &&
      sudo chmod a+w /usr/local/go/src/ &&
      curl https://glide.sh/get | sh


test:
  override:
    - glide install
    - go test -v